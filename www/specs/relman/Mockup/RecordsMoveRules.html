<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><title>Rules for Relationship Tree</title>

<link rel="stylesheet" href="https://mural.dev.java.net/css/muraldoc.css" type="text/css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1277259-2");
pageTracker._initData();
pageTracker._trackPageview();
</script></head>
<body class="view">
<h1>Rules for allowable actions on Relationship Tree</h1>
<h2>Terms<br>
</h2>
<dl>
<dt>Primary Record</dt>
<dd>The record that was selected from the initial "Select
Record" screen. &nbsp;This record is shown as the first child of
it's Domain on the Relationship Tree.<br><br>&nbsp;<img style="width: 301px; height: 60px;" alt="" src="../attach/RecordDragRules/PrimaryRecord.png"><br></dd><dt>Related Domain</dt><dd>
<p style="margin-bottom: 0in;">A domain under a relationship. &nbsp;The
domain is associated with a parent domain via a specific
relationship.&nbsp; For example, for Company -&gt;Owns Locations,
Centerpoint, &nbsp;Locations is a related domain. &nbsp; All domains on
the tree are related domains except the root domain.&nbsp;&nbsp;</p></dd><dt>
Record of the Domain</dt><dd>The record for which the relationships are established/defined<br><br><img style="width: 360px; height: 332px;" alt="" src="../attach/RecordDragRules/RecordNomenclature.png"><br></dd></dl><dl>
</dl>

<h2>Handling of the root Domain node<br>
</h2>
<br>
No actions are avialable for this node. &nbsp;<br>
<br>
<h2>Handling delete of the "Primary Record"</h2>
The first child in the Relatinship Tree is the Primary Record, its
parent is the Domain that that record belongs to.&nbsp;
&nbsp;(Example: &nbsp;UKPatient &gt; Dr. George Karlin)<br>
<br>
If the primary record is selected and the user chooses delete than all
relationships to that record are removed. &nbsp;The relationship
tree will then look like a relationship tree for a record without any
relationships. &nbsp;I.E. it will show&nbsp; Relationship
&gt; Domain &gt; <span style="color: rgb(153, 153, 153);">Add
Records</span> nodes for each Domain that the Primary Records's
domain has relationships defined for.<br>
<br>
<h2>Supported actions by context&nbsp;&nbsp;&nbsp;</h2>
<br>If &nbsp;an action is not supported at any given time the action should be
grayed out.<br><br>
<table style="text-align: left; width: 487px; height: 148px;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td class="tblheader" style="font-weight: bold; text-align: center;">Action</td>
<td class="tblheader" style="font-weight: bold; text-align: center;">Supported</td>
</tr>
<tr>
<td>Add</td>
<td>User has ManageRelationships_ReadWrite permission.<br><br>A single domain or records from a single domain are selected.<br><br>Example: The domain hospital under the Admitted to relationship is selected. <br><br>
</td>
</tr>
<tr>
<td>Move&nbsp;</td>
<td>User has ManageRelationships_ReadWrite permission.<br><br>
Appropriate nodes are selected. (Note: Refer to diagrams below)<br><br>Should be enabled only after Rearrange tree is shown.<br><br> Disabled for primary node.<br>
</td>
</tr>
<tr>
<td>Replace</td>
<td>User has ManageRelationships_ReadWrite permission.<br><br>The original source record is selected. &nbsp; <br><br>A single record is selected on the reassign tree.<br><br>Should be enabled only after Rearrange tree is shown.<br><br> Disabled for primary node.<br><br><span style="font-style: italic;">Issue</span>:
Should we support this for all records ? If a user selects a single
record it can be replaced by any record on the right hand tree? <br></td>
</tr>
<tr>
<td>Delete</td>
<td>User has ManageRelationships_ReadWrite permission.<br><br>Any node except the root node. </td>
</tr>
<tr><td>Reassign</td><td>User has ManageRelationships_ReadWrite permission.</td></tr><tr>
<td>Find</td>
<td><span style="font-weight: bold;">Maintain by Record Tree</span><br><br>A single domain or records from a single domain located under a relationship are selected.<br><br>Disabled if a relationship node is selected.<br><br> Disabled for primary node.<br><br><span style="font-weight: bold;">Rearrange Tree</span><br><br>Main domain or any record under the main domain is selected<br><br>A single domain or records from a single domain located under a relationship are selected. </td>
</tr>
<tr><td>Filter</td><td><span style="font-weight: bold;">Maintain by Record Tree</span><br><br>A single domain or records from a single domain located under a relationship are selected.<br><br>Disabled if a relationship node is selected.<br><br> Disabled for primary node.<br><br><span style="font-weight: bold;">Rearrange Tree</span><br><br>Main domain or any record under the main domain is selected<br><br>A single domain or records from a single domain located under a relationship are selected. </td></tr><tr><td>Show / Hide empty relationships</td><td>Always available.</td></tr><tr><td>Drag/Drop</td><td>The second rearrange tree must be shown. <br><br>A user can <span style="font-weight: bold;">not</span>
drag/drop records with in the relationshiip tree. &nbsp;This is
different than a hierarchy where all the nodes are the same type and it
makes sense to allow a user to rearrange records even when the
rearrange tree is hidden.</td></tr></tbody>
</table>
<p></p>
<h2>Multiseletion on record tree<br>
</h2>
<span style="font-weight: bold;"><br>
</span><span style="font-weight: bold;"></span>Typical
multi-select. &nbsp;Ctrl+MouseBtn1 or Ctrl+Space and arrows to move.<span style="font-weight: bold;"></span><br><br>User can not select the root node. &nbsp;<br><br>
A user can only move a set of records that are located under the same
parent. &nbsp; If the user has selected nodes from different
parents nodes than the Move and Drag/Drop are disabled. <br><br><br>
<h2>Selecting Reassign&nbsp;</h2>This shows a tree on the right hand side that has <span style="font-weight: bold;">all</span>
the records&nbsp;for the root domain and their associated
relationships. (The domain associated with the original record). &nbsp;<br><br>In the our example this would show all UKPatients (iregardless of if they have a relationship or not)<br><br>The records would all be collapsed to start with. &nbsp;<br><br><br>
<h2>Drag / Drop (DnD) and Move&nbsp;<br>
</h2>
First it is imporant to understand that a user is actually moving a
relationship and not a node. &nbsp;This has implications for what can
be moved where as it does not make sense to move a node from one
relationship to a different relationship. &nbsp;<br><br>When a
realtionship is moved the relationship attribute are moved with it, the
only thing that really changes is the associated records. &nbsp; For
example, relationships might be moved from Centerpoint to
BoughtCenterpoint. <br><br>For the purposes of explaining what nodes can be dragged I
will assume that the destination (reassign) tree is shown. &nbsp; When
the destination tree is shown the user can drag/drop or move from
either tree to either tree. &nbsp; This works the same way for
both trees, however for the purposes of explaining how the drag / drop
works I will show drags from the source tree to the destination tree. <br><br>Both
trees should also be updated once a node has been moved. &nbsp;
However, both&nbsp;trees should preserve what nodes where openned and
where the user has scrolled to if possible. To the user it should only look as
though the old nodes have been moved from one place to the other. <br><br><h3>General Rules</h3><ol><li>If
the “record of the domain” is same for the drop, then the drop should
not be allowed.&nbsp; In other words the “record of the domain” should
always be different for the drop.</li><li>The key condition parameters to check during the drag and drop are<br><ul><li>relationship</li><li>domain</li><li>related domain</li><li>record of the domain</li></ul></li></ol>

<h3>Primary Record</h3><br>Can not be selected for move nor drag / drop. <br><br><h3>Relationships</h3><br><br>Can be dragged to either to&nbsp;a record node under the same parent domain or the same parent domain, relationship definition.<br><br>Put more explicitly can be draged to :<br><br><ul><li>A&nbsp;record node located under the same parent domain</li><li>The same relationship definition located under a record that is in turn located under the same parent domain</li></ul><br><br>&nbsp;A relationship can only be dropped on <br><ul><li>the record node of the same parent domain</li><li>the same relationship under the same parent domain</li></ul><br><div style="margin-left: 40px;"><img style="width: 707px; height: 210px;" alt="" src="../attach/RecordDragRules/MoveRelationship.png"><br></div><br> <h4>Notes <br></h4><ul><li>The relationship attributes for the relationships move to the new relationship instance</li><li>Re-assigns &nbsp;all the relationships under each domain that is located under the same relationship definition. &nbsp;<br><br>For
example, in the above diagram all -&gt; Owns relationships in
Centerpoint&nbsp; are now assigned to BoughtCenterpoint. &nbsp; This
includes all
the relationships under the the Locations and Commodities domains.&nbsp;<br><br>This
is equivalent to having moved&nbsp;the Centerpoint &nbsp;-&gt; Owns
Locations relationships to BoughtCenterpoint&nbsp;&nbsp;-&gt; Owns
Locations and the&nbsp;Centerpoint &nbsp;-&gt; Owns&nbsp;Commodities
relationships to BoughtCenterpoint&nbsp;Owns&nbsp;Commodities.</li><li>Should show a prompt comfirming the move of the relationships.</li><li>Records under the dropped relationship&nbsp;</li><ul><li>Are&nbsp;appended to the existing records of &nbsp;the same related domain</li></ul><ul><li>If the record already exists the system should overwrite the record with the relationship information from the dropped record</li></ul></ul>
<h3>Related Domains</h3><br>Can be dragged to the same parent
domain,&nbsp;relationship definition or to the same parent domain,
relationship definition,&nbsp;domain. <br><br>Put more explicitly can be dragged when either of the following is true:<br><ul><li>All of the following are true</li></ul><ul><ul><li>Parent domain is the same</li></ul><ul><li>Relationship definition under the parent domain is the same</li></ul><li>All of the followign are true</li><ul><li>Parent domain is the same</li><li>Relationship definition under the parent domain is the same</li><li>Domain under relationship defintions is the same</li></ul></ul><br><div style="margin-left: 40px;"><img style="width: 726px; height: 209px;" alt="" src="../attach/RecordDragRules/MoveDomain.png"><br></div><br>Other drags that would not be allowed would be for a different relationship such as Person -&gt;Owns Locations. <br><h4>Notes <br></h4><ul><li>The relationship attributes for the relationships move to the new relationship instance</li><li>Re-assigns
all relationships under the selected domain. &nbsp; For example, in the
above diagram all&nbsp;Centerpoint &gt; Owns &gt; Commodities
relationships would be moved from
Centerpoint to BoughtCenterpoint. <br></li><li>Should show a prompt comfirming the move of the relationships.</li><li>Records under the moved related domains&nbsp;</li><ul><li>Are&nbsp;appended to the existing records of &nbsp;the same related domain</li></ul><ul><li>If the record already exists the system should overwrite the record with the relationship information from the dropped record</li></ul></ul><br>
<h3>Records</h3><br>Can be dragged either to the same parent domain,
relationship, domain or a record under the same parent domain,
relationship, domain.<br><br>Put more explicitly can be dragged when either of the following is true:<br><ul><li>All of these are true</li><ul><li>Parent domain is the same</li><li>Relationship definition under the parent domain is the same</li><li>Domain under the relationship definition is the same</li></ul><li>All of these are true</li><ul><li>Parent domain is the same</li><li>Relationship definition under the parent domain is the same</li><li>Domain under the relationship definition is the same</li><li>Record nodes are located under the above domain </li></ul></ul><br>In the following
example both highlighted nodes would be reassigned to BoughtCenterpoint
&gt; Owns &gt; Locations. &nbsp; Neither highlighted node could have
been dragged to Commodites because the domains do not match.
&nbsp;Finally, any of the nodes located under Locations could have been moved. <br>&nbsp;&nbsp;
<div style="margin-left: 40px;"><img style="width: 681px; height: 210px;" alt="" src="../attach/RecordDragRules/MoveRecord.png"><br></div>
<h4>Notes </h4><ul><li>The relationship attributes for the relationships move to the new relationship instance&nbsp;</li><li>Moves all selected relationships</li><li>Should
show a prompt comfirming that (N) records that will be moved. &nbsp;
Example: This will move 2 records to BoughtCenterpoint -&gt; Owns
Location. &nbsp;Do you wish to reassign these records?</li><li>Allowing
the user to drag a record to a record under the same related domain,
relationship and parent domain is a nice to have feature. &nbsp; &nbsp;</li><li>Moved records nodes</li><ul><li>Are&nbsp;appended to the existing records of &nbsp;the same related domain</li></ul><ul><li>If the record already exists the system should overwrite the record with the relationship information from the dropped record</li></ul></ul><p></p><p></p>
<div class="pageactions"> <i>This page last
changed 16-Oct-2008
01:52:00 PDT by <a href="mailto:andreakendall@dev.java.net">andreakendall@dev.java.net</a></i>
</div>
</body></html>